<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VegDelight ‚Äì Menu</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;min-height:100vh;background:linear-gradient(135deg,#dcfce7,#bbf7d0);}
/* NAVBAR */
nav{background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.1);position:sticky;top:0;z-index:10;}
.nav{max-width:1280px;margin:auto;height:64px;padding:0 16px;display:flex;align-items:center;justify-content:space-between;}
.brand{display:flex;gap:12px;align-items:center;}
.brand-icon{background:#16a34a;color:#fff;padding:8px;border-radius:8px;}
.brand h1{font-size:20px;color:#1f2937;}
.brand p{font-size:12px;color:#6b7280;}
.nav-actions{display:flex;gap:12px;align-items:center;}
.nav-actions a, .nav-actions button{border:none;background:none;cursor:pointer;padding:6px 14px;border-radius:8px;font-weight:500;}
.nav-actions a.active{background:#dcfce7;color:#16a34a;}
.cart-btn{background:#16a34a;color:#fff;position:relative;}
.badge{position:absolute;top:-6px;right:-6px;background:#dc2626;color:#fff;width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:bold;}
/* MAIN */
main{max-width:1280px;margin:auto;padding:32px 16px;}
h2{font-size:36px;color:#1f2937;}
.subtitle{color:#4b5563;margin-bottom:32px;}
.filters{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:32px;}
.filter{border:1px solid #d1d5db;background:#fff;padding:6px 20px;border-radius:999px;cursor:pointer;}
.filter.active{background:#16a34a;color:#fff;border-color:#16a34a;}
.grid{display:grid;gap:24px;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));}
.card{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 6px rgba(0,0,0,.1);transition:.2s;}
.card:hover{transform:translateY(-4px);}
.card img{width:100%;height:150px;object-fit:cover;}
.card-body{padding:20px;}
.row{display:flex;justify-content:space-between;gap:8px;}
.name{font-size:20px;font-weight:700;}
.price{background:#dcfce7;color:#16a34a;padding:4px 10px;border-radius:999px;font-weight:600;font-size:14px;}
.cat{font-size:14px;color:#6b7280;margin:4px 0;}
.desc{font-size:14px;color:#4b5563;margin-bottom:16px;}
.add{width:100%;border:none;background:#16a34a;color:#fff;padding:12px;border-radius:8px;font-weight:600;cursor:pointer;}
.add.added{background:#22c55e;transform:scale(.95);}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;z-index:40;}
.overlay.show{display:block;}
.cart{position:fixed;top:0;right:0;height:100%;width:100%;max-width:400px;background:#fff;transform:translateX(100%);transition:.3s;z-index:50;display:flex;flex-direction:column;}
.cart.open{transform:translateX(0);}
.cart-head, .cart-foot{padding:20px;border-bottom:1px solid #e5e7eb;}
.cart-foot{border-top:1px solid #e5e7eb;background:#f9fafb;}
.cart-head{display:flex;justify-content:space-between;align-items:center;font-weight:600;}
.close-btn{background:linear-gradient(135deg, #ff9a9e, #fad0c4);border:2px solid #fff;border-radius:50%;width:40px;height:40px;font-size:1.5rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.3s ease;box-shadow:0 4px 12px rgba(0,0,0,0.15);}
.close-btn:hover{transform:rotate(90deg) scale(1.2);box-shadow:0 6px 18px rgba(0,0,0,0.2);border-color:#ff6f91;}
.items{flex:1;overflow:auto;padding:20px;}
.item{background:#f9fafb;border-radius:8px;padding:12px;display:flex;gap:12px;margin-bottom:12px;}
.item img{width:70px;height:70px;border-radius:8px;object-fit:cover;}
.controls{display:flex;gap:8px;align-items:center;margin-top:4px;}
.q{border:1px solid #d1d5db;background:#fff;padding:2px 8px;border-radius:4px;cursor:pointer;}
.remove{margin-left:auto;border:none;background:none;color:#dc2626;cursor:pointer;}
.checkout{width:100%;border:none;background:#16a34a;color:#fff;padding:14px;border-radius:8px;font-weight:600;cursor:pointer;}
.qty-overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;z-index:100;align-items:center;justify-content:center;}
.qty-overlay.show{display:flex;}
.qty-modal{background:#fff;border-radius:12px;padding:32px;width:90%;max-width:320px;box-shadow:0 10px 40px rgba(0,0,0,.2);text-align:center;}
.qty-modal h3{font-size:20px;margin-bottom:20px;color:#1f2937;}
.qty-controls{display:flex;align-items:center;justify-content:center;gap:16px;margin-bottom:24px;}
.qty-btn{background:#16a34a;color:#fff;border:none;width:40px;height:40px;border-radius:8px;cursor:pointer;font-size:18px;font-weight:600;}
.qty-btn:hover{background:#15803d;}
.qty-display{font-size:24px;font-weight:700;color:#1f2937;min-width:60px;}
.qty-actions{display:flex;gap:12px;}
.qty-add{flex:1;background:#16a34a;color:#fff;border:none;padding:12px;border-radius:8px;cursor:pointer;font-weight:600;}
.qty-add:hover{background:#15803d;}
.qty-cancel{flex:1;background:#e5e7eb;color:#1f2937;border:none;padding:12px;border-radius:8px;cursor:pointer;font-weight:600;}
.qty-cancel:hover{background:#d1d5db;}
</style>
</head>
<body onload="initApp()">

<nav>
  <div class="nav">
    <div class="brand">
      <div class="brand-icon">ü•¨</div>
      <div>
        <h1>VegDelight</h1>
        <p>Fresh Vegetarian Food</p>
      </div>
    </div>
    <div class="nav-actions">
      <a class="active">Menu</a>
      <a>Orders</a>
      <button class="cart-btn" onclick="toggleCart()">üõí<span id="count" class="badge">0</span></button>
      <button onclick="logout()">üö™</button>
    </div>
  </div>
</nav>

<main>
  <h2>Our Menu</h2>
  <p class="subtitle">Fresh vegetarian dishes made with love</p>
  <div class="filters" id="filters"></div>
  <div class="grid" id="grid"></div>
</main>

<div class="overlay" id="overlay" onclick="toggleCart()"></div>
<div class="cart" id="cart">
  <div class="cart-head">
    <span>Your Cart</span>
    <button class="close-btn" onclick="toggleCart()">‚ùå</button>
  </div>
  <div class="items" id="cart-items"></div>
  <div class="cart-foot">
    <strong id="cart-total">Total: ‚Çπ0.00</strong>
    <button class="checkout" onclick="checkout()">Checkout</button>
  </div>
</div>

<div class="qty-overlay" id="qty-overlay">
  <div class="qty-modal">
    <h3 id="qty-title">Select Quantity</h3>
    <div class="qty-controls">
      <button class="qty-btn" onclick="decreaseQty()">‚àí</button>
      <div class="qty-display" id="qty-value">1</div>
      <button class="qty-btn" onclick="increaseQty()">+</button>
    </div>
    <div class="qty-actions">
      <button class="qty-add" onclick="confirmQty()">Add to Cart</button>
      <button class="qty-cancel" onclick="closeQtyModal()">Cancel</button>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyBAfAOtcgECePqbIwgKJ0Uc9tsV3w96vZs",
  authDomain: "editor-7f117.firebaseapp.com",
  projectId: "editor-7f117",
  storageBucket: "editor-7f117.firebasestorage.app",
  messagingSenderId: "1019548750180",
  appId: "1:1019548750180:web:341dec1ec6d612f8e12a71"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let MENU = [];
let cartData = [];
let activeFilter = 'All';
let currentItemId = null;
let currentQty = 1;

// --- Load Menu from Firestore ---
async function loadMenu() {
  const snapshot = await getDocs(collection(db, "foodItems"));
  MENU = snapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
  buildFilters();
  renderMenu();
}

// --- Filters ---
function buildFilters() {
  const filters = document.getElementById('filters');
  const categories = ['All', ...new Set(MENU.map(i => i.cat))];
  filters.innerHTML = '';
  categories.forEach(cat => {
    const btn = document.createElement('button');
    btn.className = 'filter' + (cat === activeFilter ? ' active' : '');
    btn.innerText = cat;
    btn.onclick = () => { activeFilter = cat; buildFilters(); renderMenu(); };
    filters.appendChild(btn);
  });
}

// --- Render Menu ---
function renderMenu() {
  const grid = document.getElementById('grid');
  grid.innerHTML = '';
  MENU.filter(i => activeFilter === 'All' || i.cat === activeFilter)
      .forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <img src="${item.img}">
          <div class="card-body">
            <div class="name">${item.name}</div>
            <div class="cat">${item.cat}</div>
            <div class="desc">${item.desc}</div>
            <div class="row">
              <div class="price">‚Çπ${item.price.toFixed(2)}</div>
            </div>
            <button class="add" onclick="openQtyModal('${item.id}')">Add to Cart</button>
          </div>
        `;
        grid.appendChild(card);
      });
}

// --- Quantity Modal ---
window.openQtyModal = function(id) {
  currentItemId = id;
  currentQty = 1;
  document.getElementById('qty-value').innerText = currentQty;
  const item = MENU.find(i => i.id === id);
  document.getElementById('qty-title').innerText = item.name;
  document.getElementById('qty-overlay').classList.add('show');
}

window.closeQtyModal = function() {
  document.getElementById('qty-overlay').classList.remove('show');
}

window.increaseQty = function() { currentQty++; document.getElementById('qty-value').innerText = currentQty; }
window.decreaseQty = function() { if(currentQty>1){ currentQty--; document.getElementById('qty-value').innerText = currentQty; } }

window.confirmQty = function() {
  const item = MENU.find(i => i.id === currentItemId);
  const cartItem = cartData.find(i => i.id === currentItemId);
  if(cartItem) cartItem.qty += currentQty;
  else cartData.push({...item, qty: currentQty});
  localStorage.setItem('cart', JSON.stringify(cartData));
  renderCart();
  closeQtyModal();
}

// --- Cart Functions ---
window.toggleCart = function() {
  document.getElementById('cart').classList.toggle('open');
  document.getElementById('overlay').classList.toggle('show');
}

function renderCart() {
  const container = document.getElementById('cart-items');
  container.innerHTML = '';
  let total = 0;
  cartData.forEach(i => {
    total += i.price * i.qty;
    const div = document.createElement('div');
    div.className = 'item';
    div.innerHTML = `
      <img src="${i.img}">
      <div>
        <div class="name">${i.name}</div>
        <div class="controls">
          <button class="q" onclick="changeQty('${i.id}', -1)">‚àí</button>
          <span>${i.qty}</span>
          <button class="q" onclick="changeQty('${i.id}', 1)">+</button>
        </div>
      </div>
      <button class="remove" onclick="removeItem('${i.id}')">√ó</button>
    `;
    container.appendChild(div);
  });
  document.getElementById('cart-total').innerText = `Total: ‚Çπ${total.toFixed(2)}`;
  document.getElementById('count').innerText = cartData.reduce((a,b)=>a+b.qty,0);
}

window.changeQty = function(id, delta) {
  const item = cartData.find(i => i.id === id);
  if(!item) return;
  item.qty += delta;
  if(item.qty <= 0) removeItem(id);
  else renderCart();
  localStorage.setItem('cart', JSON.stringify(cartData));
}

window.removeItem = function(id) {
  cartData = cartData.filter(i => i.id !== id);
  localStorage.setItem('cart', JSON.stringify(cartData));
  renderCart();
}

// --- Checkout & Logout ---
window.checkout = function() {
  // Save cart to localStorage (already done in your code)
  localStorage.setItem('cart', JSON.stringify(cartData));
  // Redirect to checkout page
  location.href = "checkout.html";
}

window.logout = function() { location.href = "index.html" }

// --- Initialize App ---
function initApp() {
  loadMenu();
  cartData = JSON.parse(localStorage.getItem('cart') || '[]');
  renderCart();
}

initApp();
</script>


</body>
</html>
